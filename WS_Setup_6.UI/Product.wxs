<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">

	<Product Id="*"
			 Name="$(var.ProductName)"
			 Language="1033"
			 Version="$(var.ProductVersion)"
			 Manufacturer="$(var.Manufacturer)"
			 UpgradeCode="{42C9E694-355E-4D5E-BCC7-2FC2F50AC4BE}">

		<Package InstallerVersion="500"
				 Compressed="yes"
				 InstallScope="perMachine" />

		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<MediaTemplate />

		<Feature Id="ProductFeature" Title="$(var.ProductName)" Level="1">
			<ComponentGroupRef Id="AppFilesGroup" />
			<ComponentRef Id="MainExeComponent" />
			<!-- Ensure EXE component is in the feature -->
		</Feature>

		<Icon Id="AppIcon" SourceFile="Assets\AdvTechLogo.ico" />
		<Property Id="ARPPRODUCTICON" Value="AppIcon" />

	</Product>

	<!-- Directories -->
	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
			<Directory Id="ProgramFilesFolder">
				<Directory Id="INSTALLFOLDER" Name="$(var.ProductName)" />
			</Directory>
		</Directory>
	</Fragment>

	<!-- Component for the installed EXE -->
	<Fragment>
		<DirectoryRef Id="INSTALLFOLDER">
			<Component Id="MainExeComponent" Guid="PUT-GUID-HERE">
				<File Id="MainExeFile"
					  Source="$(var.WS_Setup_6.UI.TargetPath)"
					  KeyPath="yes" />
			</Component>
		</DirectoryRef>
	</Fragment>

	<!-- Custom Action to run the EXE -->
	<Fragment>
		<CustomAction Id="RunMainExe"
					  FileRef="MainExeFile"
					  ExeCommand=""
					  Execute="deferred"
					  Impersonate="no"
					  Return="asyncNoWait" />

		<InstallExecuteSequence>
			<Custom Action="RunMainExe" After="InstallFinalize">
				NOT Installed
			</Custom>
		</InstallExecuteSequence>
	</Fragment>

</Wix>